@use "../base/helpers/type-helper" as *;
@use "../abstracts/mixins" as *;
@use "../abstracts/variables" as *;

[class*="form"] {
	--_error-color: hsl(14 100% 50%);
	--_pad_x: 1.25rem;
}
.form {
	&__group {
		position: relative;
		display: block;

		&:has(:focus-within) {
			& + .form__group {
				.form__input {
					@include media(992px) {
						&:after {
							content: "Tab";
							position: absolute;
							inset-inline-end: var(--_pad_x);
							inset-block-start: 50%;
							translate: 0 -50%;
							padding: 0.25em 2em 0.25em 1em;
							border-radius: 0.5rem;
							background-color: var(--clr-neutral-600);
							background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='lucide lucide-arrow-right-to-line-icon lucide-arrow-right-to-line'%3E%3Cpath d='M17 12H3'/%3E%3Cpath d='m11 18 6-6-6-6'/%3E%3Cpath d='M21 5v14'/%3E%3C/svg%3E");
							background-size: 0.9rem;
							background-repeat: no-repeat;
							background-position: 80% center; // padding:
						}

						&:has(textarea) {
							&:after {
								inset-block-start: var(--_pad_y, 0);
								translate: 0 50%;
							}
						}
					}
				}
			}
		}

		&.error {
			.form {
				&__label {
					color: var(--_error-color);
				}
			}
			.error-message {
				text-transform: uppercase;
				font-family: "Space Mono";
				letter-spacing: 0.01em;
				font-size: 0.75rem;
				text-align: right;
				display: block;
				visibility: visible;
				opacity: 1;
				transition: opacity 0.2s ease-out;
			}
		}

		&.error {
			.form {
				&__label {
					font-size: 0.875rem;
					top: 1em;
					transform: translateY(0);
					transition: 0.2s ease-out;
				}
				&-control {
					padding: 1.25em var(--_pad_x) 0.25em;
				}
			}
		}
		&:has(textarea.form__control) {
			inline-size: 100%;
			.form__line {
				align-items: flex-start;
			}

			.form__description {
				padding-block-start: 0.5em;
			}
		}
	}

	&__control {
		inline-size: 100%;
		padding: var(--_pad_y, 0.5em) var(--_pad_x, 1em);
		background-color: transparent;
		border: 1px solid var(--clr-neutral-600);
		outline: none;
		font-size: 1rem;
		border-radius: 100vmax;
		box-shadow: none !important;
		text-transform: uppercase;
		letter-spacing: -0.03em;
		color: var(--clr-neutral-200);
		font-weight: 400;

		&::placeholder {
			color: var(--clr-neutral-500);
			text-transform: none;
		}
		&:focus {
			color: var(--clr-neutral-100);
			border-color: var(--clr-neutral-500);
			background-color: hsl(from var(--clr-neutral-600) h s 10% / 100%);
		}
		&:autofill {
			border: 1px solid hsl(0 0% 100% / 15%);
			box-shadow: 0 0 0 5rem hsl(0 0% 10% / 100%) inset !important;
			-webkit-box-shadow: 0 0 0 5rem hsl(0 0% 10% / 100%) inset !important;
			-webkit-text-fill-color: white !important;
		}

		&:-webkit-autofill {
			border: 1px solid hsl(0 0% 100% / 15%);
			-webkit-box-shadow: 0 0 0 5rem hsl(0 0% 10% / 100%) inset !important;
			-webkit-text-fill-color: white !important;
		}

		&.inverted {
			color: var(--clr-neutral-700);
			background-color: transparent;
			&::placeholder {
				color: var(--clr-neutral-300);
				text-transform: none;
			}
			&:focus {
				color: var(--clr-neutral-700);
				border-color: var(--clr-neutral-700);
				background-color: hsl(from var(--clr-neutral-700) h s l / 10%);
			}
			&:autofill {
				border: 1px solid var(--clr-neutral-300);
				box-shadow: 0 0 0 5rem hsl(from var(--clr-neutral-700) h s l / 5%) inset !important;
				-webkit-box-shadow: 0 0 0 5rem hsl(from var(--clr-neutral-700) h s l / 5%) inset !important;
				-webkit-text-fill-color: var(--clr-neutral-700) !important;
			}

			&:-webkit-autofill {
				border: 1px solid var(--clr-neutral-300);
				box-shadow: 0 0 0 5rem hsl(from var(--clr-neutral-700) h s l / 5%) inset !important;
				-webkit-box-shadow: 0 0 0 5rem hsl(from var(--clr-neutral-700) h s l / 5%) inset !important;
				-webkit-text-fill-color: var(--clr-neutral-700) !important;
			}
		}
	}
	&__description {
		flex-shrink: 0;
	}
	&__line {
		display: flex;
		align-items: center;
		.form {
			&__control {
				@extend .regular-20;
				padding: 1em 1.6em;

				&:is(textarea) {
					border-radius: 2rem;
				}
			}
		}
		@include media-x(767px) {
			flex-direction: column;
			align-items: flex-start;
			gap: 0.5rem;
		}
	}
	&__input {
		position: relative;
		inline-size: min(25rem, 100%);
		&:has(.form__control[type="email"]) {
			inline-size: min(40rem, 100%);
		}
		&:has(textarea) {
			inline-size: 100%;
		}
	}

	&__label {
		z-index: 1;
		color: var(--clr-neutral-300);
		font-weight: 500;
		font-size: 0.75rem;
		font-family: var(--set-heading-font);
		transition: 0.2s ease-out;
		text-transform: uppercase;
		pointer-events: none;
	}
}
.error-message {
	font-size: 0.875rem;
	position: absolute;
	top: calc(100% + 0.5em);
	left: 0;
	padding-inline: var(--_pad_x);
	color: var(--_error-color);
	visibility: hidden;
	opacity: 0;
	transition: opacity 0.2s ease-out;
}

.form {
	&--required {
		--indicator-color: var(--clr-neutral-500);
		&:after {
			content: "required";
			position: absolute;
			inset-inline-end: 0;
			inset-block-start: 0;
			padding: 0.75em 2em;
			font-size: 0.75em;
			color: var(--indicator-color);
			text-transform: uppercase;
			font-family: $code-font-stack;
			user-select: none;
			pointer-events: none;
		}

		&:focus-within {
			--indicator-color: var(--clr-neutral-200);
		}
	}
}

[class*="select-"] {
	appearance: none;
	--_border-color: var(--clr-neutral-600);
	--_background-color: var(--_clr-neutral-700);
	--_color: var(--clr-neutral-200);
	outline: none;
	display: inline-flex;
	padding: var(--_pad_y, 0.5em) 2em var(--_pad_y, 0.5em) var(--_pad_x, 1em);
	border-radius: 100vmax;
	background-color: var(--_background-color);
	background-image: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M15.9902 10.889L12.0022 14.307L8.01416 10.889L8.99016 9.74902L12.0022 12.331L15.0142 9.75002L15.9902 10.889Z' fill='white'/%3E%3C/svg%3E%0A");
	background-position: 96% center;
	background-repeat: no-repeat;

	border: 1px solid var(--_border-color);
	font-size: 1rem;
	color: var(--_color);
	// transition: 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);

	&:focus {
		--_background-color: var(--clr-neutral-600);
		--_color: var(--clr-neutral-100);
		--_border-color: var(--set-ui-highlight-color);
	}
}

[class*="select-"],
[class*="form-"] {
	@media screen and (max-width: 991px) {
		--_pad_y: 0.75em;
	}
}
